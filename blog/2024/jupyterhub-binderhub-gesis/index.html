<!doctype html><!-- This site was created with Hugo Blox. https://hugoblox.com --><!-- Last Published: May 31, 2024 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Hugo Blox Builder 5.9.7"><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&family=Work+Sans:wght@400;700" rel=stylesheet><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.26c458e6907dc03073573976b7f4044e.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1.9.4/css/academicons.min.css integrity="sha512-IW0nhlW5MgNydsXJO40En2EoCkTTjZhI3yuODrZIc8cQ4h1XcF53PsqDHa09NqnkXuIe0Oiyyj171BqZFwISBw==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.css integrity crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.fdd12878bd500a9914cd98e415f222c7.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><script async src="https://www.googletagmanager.com/gtag/js?id=G-5TYM6H87D9"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}function trackOutboundLink(e,t){gtag("event","click",{event_category:"outbound",event_label:e,transport_type:"beacon",event_callback:function(){t!=="_blank"&&(document.location=e)}}),console.debug("Outbound link clicked: "+e)}function onClickCallback(e){if(e.target.tagName!=="A"||e.target.host===window.location.host)return;trackOutboundLink(e.target,e.target.getAttribute("target"))}gtag("js",new Date),gtag("config","G-5TYM6H87D9",{}),gtag("set",{cookie_flags:"SameSite=None;Secure"}),document.addEventListener("click",onClickCallback,!1)</script><meta name=author content="Chris Holdgraf"><meta name=description content="Thanks to Arnim Bleier , Jenny Wong , Georgiana Elena , Damián Avila , Jim Colliander and James Munroe for contributing to this blog post
mybinder.org is a very popular service that allows end users to specify and share the environment (languages, packages, etc) required for their notebooks to run correctly by placing configuration files they are already familiar with (like requirements."><link rel=alternate hreflang=en-us href=https://2i2c.org/blog/2024/jupyterhub-binderhub-gesis/><link rel=canonical href=https://2i2c.org/blog/2024/jupyterhub-binderhub-gesis/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu8b94e13e0b17eede442ff7e6dd19ef02_1559_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu8b94e13e0b17eede442ff7e6dd19ef02_1559_180x180_fill_lanczos_center_3.png><meta name=theme-color content="rgb(29, 78, 245)"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@2i2c_org"><meta property="twitter:creator" content="@2i2c_org"><meta property="twitter:image" content="https://2i2c.org/media/opengraph-image-template_hu51a874180150a55e631114d14958827e_26672_filter_7154883714494007766.png"><meta property="og:type" content="website"><meta property="og:site_name" content="2i2c"><meta property="og:url" content="https://2i2c.org/blog/2024/jupyterhub-binderhub-gesis/"><meta property="og:title" content="Integrating BinderHub with JupyterHub: Empowering users to manage their own environments | 2i2c"><meta property="og:description" content="Thanks to Arnim Bleier , Jenny Wong , Georgiana Elena , Damián Avila , Jim Colliander and James Munroe for contributing to this blog post
mybinder.org is a very popular service that allows end users to specify and share the environment (languages, packages, etc) required for their notebooks to run correctly by placing configuration files they are already familiar with (like requirements."><meta property="og:image" content="https://2i2c.org/media/opengraph-image-template_hu51a874180150a55e631114d14958827e_26672_filter_7154883714494007766.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2024-01-03T16:56:14-08:00"><meta property="article:modified_time" content="2024-01-12T12:11:55-08:00"><title>Integrating BinderHub with JupyterHub: Empowering users to manage their own environments | 2i2c</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=c9a2f2b9d4451cdafd606c391e5b036e><script src=/js/wowchemy-init.min.1db830ffe01a1cc59425dcc73c1fdaa8.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/media/logo.svg alt=2i2c></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/media/logo.svg alt=2i2c></a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/platform/><span>Cloud platform</span></a></li><li class=nav-item><a class=nav-link href=/communities/><span>Community network</span></a></li><li class=nav-item><a class=nav-link href=/right-to-replicate/><span>Right to Replicate</span></a></li><li class="nav-item dropdown"><a href=# class="nav-link dropdown-toggle" data-toggle=dropdown aria-haspopup=true><span>About</span><span class=caret></span></a><div class=dropdown-menu><a class=dropdown-item href=/organization/><span>Team and organization</span></a>
<a class=dropdown-item href=/mission/><span>Mission, values, and strategy</span></a>
<a class=dropdown-item href=/projects/><span>Projects we support</span></a>
<a class=dropdown-item href=/founders/><span>Origin story</span></a>
<a class=dropdown-item href=/jobs/><span>Jobs at 2i2c</span></a>
<a class=dropdown-item href=/collaborate/><span>Contact us to collaborate</span></a>
<a class=dropdown-item href=/donate/><span>Donate to 2i2c</span></a></div></li></ul><ul class="navbar-nav ml-md-auto"><li class=nav-item><a class=nav-link href=/blog><span>blog</span></a></li><li class=nav-item><a class=nav-link href=https://docs.2i2c.org target=_blank rel=noopener><span>docs</span></a></li><li class=nav-item><a class=nav-link href=https://docs.2i2c.org/support target=_blank rel=noopener><span>support</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span>
</a><a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span>
</a><a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Integrating BinderHub with JupyterHub: Empowering users to manage their own environments</h1><div class=article-metadata><div><span><a href=/author/yuvi-panda/>Yuvi Panda</a></span></div><span class=article-date>Last updated on
Jan 12, 2024
</span><span class=middot-divider></span>
<span class=article-categories><i class="fas fa-folder mr-1"></i><a href=/category/engineering/>Engineering</a>, <a href=/category/partnerships/>Partnerships</a>, <a href=/category/updates/>Updates</a></span></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:720px;max-height:377px><div style=position:relative><img src=/media/opengraph-image-template_hu51a874180150a55e631114d14958827e_26672_9887cba387aa003a1554c08256528c1e.webp width=720 height=377 alt class=featured-image></div></div><div class=article-container><div class=article-style><p><em>Thanks to
<a href=https://www.gesis.org/en/institute/staff/person/arnim.bleier target=_blank rel=noopener>Arnim Bleier</a>
,
<a href=https://jnywong.github.io/ target=_blank rel=noopener>Jenny Wong</a>
,
<a href=https://github.com/GeorgianaElena target=_blank rel=noopener>Georgiana Elena</a>
,
<a href=https://github.com/damianavila target=_blank rel=noopener>Damián Avila</a>
,
<a href=https://colliand.com/ target=_blank rel=noopener>Jim Colliander</a>
and
<a href=https://github.com/jmunroe target=_blank rel=noopener>James Munroe</a>
for contributing to this blog post</em></p><p><a href=https://mybinder.org target=_blank rel=noopener>mybinder.org</a>
is a very popular service that allows end users to specify and share the environment (languages, packages, etc) required for their notebooks to run correctly by placing
<a href=https://repo2docker.readthedocs.io/en/latest/config_files.html#config-files target=_blank rel=noopener>configuration files</a>
they are already familiar with (like <code>requirements.txt</code> or <code>environment.yml</code>) along with their notebooks. While not without its own set of challenges, this is extremely powerful because it puts control of the <em>environment</em> in the hands of the people who write the code. They can customize the environment to fit the needs of their code, instead of having to fit their code into the environment that admins have made available.</p><p>But, mybinder.org (and the
<a href=https://github.com/jupyterhub/binderhub/ target=_blank rel=noopener>BinderHub</a>
software that powers it) is built for <em>sharing</em> your work after you are done with it, <em>not</em> for actively doing work. BinderHubs often do not have persistent storage nor persistent user identity, and UX is centered around <em>ephemeral</em> interactivity that can be shared with others (via a link), rather than <em>persistent</em> interactivity that a single user repeatedly comes back to.
<a href=https://jupyter.org/hub target=_blank rel=noopener>JupyterHub</a>
is more commonly used for this kinda workflow, but doesn&rsquo;t currently have the ability for users to easily build their own environments. Admins who are <em>running</em> the JupyterHub can make
<a href=https://z2jh.jupyter.org/en/stable/jupyterhub/customizing/user-environment.html#using-multiple-profiles-to-let-users-select-their-environment target=_blank rel=noopener>multiple environments</a>
available for users to choose from, but this still puts admins in the critical path for environment customization.</p><p>Our
<a href=https://2i2c.org/blog/2022/gesis-2i2c-collaboration-update/ target=_blank rel=noopener>collaboration</a>
with
<a href=http://notebooks.gesis.org target=_blank rel=noopener>GESIS</a>
,
<a href=https://www.nfdi4datascience.de target=_blank rel=noopener>NFDI4DS</a>
, and
<a href=https://www.cessda.eu target=_blank rel=noopener>CESSDA</a>
, aims to bring this flexibility to JupyterHub directly. We aim to empower users to decide for themselves which applications and dependencies are installed on a per-project basis. Our work enables communities with heterogeneous requirements to share a single Hub. Our approach frees administrators from being overwhelmed by installation requests and transforms the JupyterHub platform into a platform for collaborative computational reproducibility. In this update, we report on our progress and upcoming steps in this project.</p><h2 id=what-does-a-binderhub-do-exactly>What does a BinderHub do, exactly?
<a class=header-anchor href=#what-does-a-binderhub-do-exactly>#</a></h2><p>It is helpful to understand that BinderHub primarily has 3 responsibilities:</p><ol><li>Present a UI to the end user for them to provide details on what to build (this is what you see when you go to mybinder.org)</li><li>Call out to
<a href=https://github.com/jupyterhub/repo2docker target=_blank rel=noopener>repo2docker</a>
in a scalable way to actually <em>build and push</em> an image containing the environment for the given repository, and show the user logs as this build process happens. This also allows users to debug issues with their build more easily.</li><li>Talk to a JupyterHub instance to launch a user server with the built docker image, and redirect the user to this.</li></ol><p>(2) is really the <em>core</em> feature of BinderHub, and we settled on figuring out how to make that available to JupyterHub users. It was really important to us that this was also done in a way that can be sustainably used by <em>everyone</em>, not just 2i2c. This blog post discusses the various improvements to the broad ecosystem of projects in the Jupyter ecosystem to get this done.</p><h2 id=demo>Demo
<a class=header-anchor href=#demo>#</a></h2><p>But first, a very quick demo of how this looks like right now now!</p><!-- generated from original .mov screen recording with `ffmpeg -i screencast.mov -c:v libx264 screencast.mp4` --><p><video src=./screencast.mp4 autoplay muted controls></video></p><p>This is very much a work in progress, but the basic flow can be seen clearly. Users see a Server Options menu after they log into JupyterHub. They can specify the two primary things that determine the server configuration:</p><ol><li><p>The resources allocated (RAM, CPU and maybe GPU)</p></li><li><p>The environment (container image) used, which can be specified in one of 3 ways:</p><p>a. A pre-selected list of environments (container images), provided by the administrators who set up this JupyterHub
b. A blank text box where you can enter any publicly available docker image they want
c. A mybinder.org style way to specify a GitHub repository, which will be then dynamically built into a docker image for the user!</p></li></ol><p>So what did we need to do to accomplish this, in a way that&rsquo;s very upstream friendly and usable by everyone (and not just 2i2c)?</p><h2 id=a-standalone-binderhub-service-helm-chart>A Standalone <code>binderhub-service</code> helm chart
<a class=header-anchor href=#a-standalone-binderhub-service-helm-chart>#</a></h2><p>The default upstream
<a href=https://github.com/jupyterhub/binderhub/tree/main/helm-chart target=_blank rel=noopener>BinderHub helm chart</a>
<em>includes</em> a JupyterHub as a dependency, and configures itself to be used primarily in a manner similar to
<a href=https://mybinder.org target=_blank rel=noopener>mybinder.org</a>
. As the person who helped make that choice early on, I can tell you why it was made - for convenience! And it <em>was</em> very convenient, as it allowed us to get mybinder.org going fast. However, it makes it difficult to install a BinderHub service <em>alongside</em> an existing JupyterHub. To this end, we have created a standalone
<a href=https://github.com/2i2c-org/binderhub-service/ target=_blank rel=noopener>BinderHub helm chart</a>
, designed to be installed <em>alongside</em> an existing JupyterHub, so we can use it <em>purely</em> to build images. This allows the BinderHub instance to be used as a
<a href=https://jupyterhub.readthedocs.io/en/stable/reference/services.html target=_blank rel=noopener>JupyterHub Service</a>
, which is what we want.</p><p>While this helm chart is currently under the 2i2c GitHub org, the hope is that it can eventually migrate to a
<a href=https://github.com/jupyterhub/team-compass/issues/519 target=_blank rel=noopener>jupyterhub-contrib</a>
organization (once it is created), or it can become the upstream helm chart for BinderHub if enough work can be done in BinderHub to allow it to serve use cases like mybinder.org.</p><p>As part of this work, we also added a way for BinderHub to run in
<a href=https://github.com/jupyterhub/binderhub/pull/1647 target=_blank rel=noopener>API only mode</a>
, so we can fully turn off the UI <em>and</em> launching ability of BinderHub. This change decoupled the
<a href>three responsibilities of BinderHub</a>
we discussed previously, allowing us to bring our own UI and JupyterHub. BinderHub could now be used <em>purely</em> for its scalable image building features, which is exactly what we want!</p><h2 id=sustainably-extending-kubespawners-profilelist>Sustainably extending KubeSpawner&rsquo;s <code>profileList</code>
<a class=header-anchor href=#sustainably-extending-kubespawners-profilelist>#</a></h2><p>We identified KubeSpawner&rsquo;s <code>profileList</code> feature as the ideal location for UI to dynamically build environments (container images), making it just another &rsquo;environment choice&rsquo; people can choose, along with picking the resources their server needs. From an end-user perspective, it was also the logical place for them to specify a repository to build into an environment, as they could already choose some pre-built environments from here. They can also select other arbitrary resources they want (such as memory, GPU, etc) from here as well. From a maintainer perspective, it helps with long-term maintenance of the JupyterHub projects.</p><p>The implementation of <code>profileList</code> however, was not easy to extend at this point. So
<a href=https://github.com/jupyterhub/kubespawner/pull/724 target=_blank rel=noopener>this PR</a>
improved how easy it was to extend it in more complex ways, without making the implementation in KubeSpawner itself complicated. Even though this had <em>no</em> visible end-user effects, it was an extremely important step in allowing us to experiment with UI in a <em>sustainable</em> way without having to rely on upstream. These kinds of changes can sometimes be hard to sell to stakeholders but are extremely important in ensuring a continuous and sustainable relationship with upstream.</p><h2 id=implementing-unlisted_choice-feature-in-kubespawner>Implementing <code>unlisted_choice</code> feature in KubeSpawner
<a class=header-anchor href=#implementing-unlisted_choice-feature-in-kubespawner>#</a></h2><p>The profileList feature was built to allow JupyterHub <em>admins</em> to specify an explicit list of container images the end-user can choose from. It did not have a way for any choice that was <em>not</em> pre-approved by the admin to be used. We needed this feature since the BinderHub API will build a new docker image for each environment the user wants, and so this can not be chosen from a pre-approved list. We had to safely add this feature to KubeSpawner in such a way that it was generally useful to everyone. Many other communities had been asking for such a feature anyway - the ability to simply &rsquo;type in&rsquo; an image and have that be used.</p><p><a href=https://www.earthdata.nasa.gov/esds/veda target=_blank rel=noopener>NASA VEDA</a>
was one such community, so we partnered with
<a href=https://github.com/batpad/ target=_blank rel=noopener>Sanjay Bhangar</a>
from
<a href=https://developmentseed.org/ target=_blank rel=noopener>Development Seed</a>
(an organization that helps run NASA VEDA) to implement this feature. Engineers from 2i2c contributed heavily to this feature as well, and after <em>several</em> PRs (
<a href=https://github.com/jupyterhub/kubespawner/pull/735 target=_blank rel=noopener>1</a>
,
<a href=https://github.com/jupyterhub/kubespawner/pull/766 target=_blank rel=noopener>2</a>
,
<a href=https://github.com/jupyterhub/kubespawner/pull/773 target=_blank rel=noopener>3</a>
,
<a href=https://github.com/jupyterhub/kubespawner/pull/774 target=_blank rel=noopener>4</a>
and
<a href=https://github.com/jupyterhub/kubespawner/pull/777 target=_blank rel=noopener>5</a>
), this feature is now available for everyone to use!</p><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=./screenshot.png alt="Screenshot of Kubernetes Profiles with Unlisted Choice" loading=lazy data-zoomable></div></div></figure></p><p>A key component of doing <em>sustainable</em> upstream work is that every addition needs to be useful by itself for a broad group of people. This change was very helpful for many communities that wanted to allow their users the freedom to pick whatever image they want to use, regardless of wether they wanted to use dynamic image building or not. The broad interest allowed us to build a coalition with other interested parties, and get the change accepted upstream more easily!</p><h2 id=jupyterhub-fancy-profiles><code>jupyterhub-fancy-profiles</code>
<a class=header-anchor href=#jupyterhub-fancy-profiles>#</a></h2><p>Once we had all these pieces in place, it was time to actually work on the frontend UI that would allow users to build images dynamically and launch them. Since this will replace the &lsquo;profileList&rsquo; feature, it should also allow them to select different resources (RAM, CPU, etc) as needed, as well as type in an existing image if they desire. So it was a full re-implementation of the <code>profileList</code> frontend.</p><p>This is ongoing now at the
<a href=https://github.com/yuvipanda/jupyterhub-fancy-profiles target=_blank rel=noopener>jupyterhub-fancy-profiles</a>
project. It is a pure frontend web application, using modern frontend tooling (
<a href=https://react.dev/ target=_blank rel=noopener>React</a>
,
<a href=https://webpack.js.org/ target=_blank rel=noopener>webpack</a>
,
<a href=https://babeljs.io/ target=_blank rel=noopener>Babel</a>
, etc) and written in JavaScript. It&rsquo;s gone through a few revisions, but the demo provided earlier in the blog post is in its current state. Because the default profileList implementation is pure HTML / CSS with very <em>minimal</em> JS, it is limited in what kind of UX it could have. <code>jupyterhub-fancy-profiles</code> aims to be very helpful <em>even</em> when dynamic image-building features are not enabled on a JupyterHub. We hope to roll this out to a few JupyterHubs and improve it over time based on feedback.</p><h2 id=jupyterhubbinderhub-clienthttpswwwnpmjscompackagejupyterhubbinderhub-client-npm-package><a href=https://www.npmjs.com/package/@jupyterhub/binderhub-client target=_blank rel=noopener><code>jupyterhub/@binderhub-client</code></a>
npm package
<a class=header-anchor href=#jupyterhubbinderhub-clienthttpswwwnpmjscompackagejupyterhubbinderhub-client-npm-package>#</a></h2><p>While building <code>jupyterhub-fancy-profiles</code>, we wanted to use the <em>same</em> javascript code used by BinderHub frontend to interact with the BinderHub API, instead of re-implementing it. However, the existing BinderHub JavaScript code was not easily consumable by external projects. We refactored the code, added tests, migrated to use modern JS practices and published the
<a href=https://www.npmjs.com/package/@jupyterhub/binderhub-client target=_blank rel=noopener><code>jupyterhub/@binderhub-client</code> NPM package</a>
that can be used not just by <code>jupyerhub-fancy-profiles</code> but any external project for talking to the BinderHub API.</p><p>This had to be done in such a way that current BinderHub installations (such as mybinder.org) do not break. That took quite a few pull requests:
<a href=https://github.com/jupyterhub/binderhub/pull/1689 target=_blank rel=noopener>1</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1693 target=_blank rel=noopener>2</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1694 target=_blank rel=noopener>3</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1741 target=_blank rel=noopener>4</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1742 target=_blank rel=noopener>5</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1758 target=_blank rel=noopener>6</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1761 target=_blank rel=noopener>7</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1771 target=_blank rel=noopener>8</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1773 target=_blank rel=noopener>9</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1775 target=_blank rel=noopener>10</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1778 target=_blank rel=noopener>11</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1779 target=_blank rel=noopener>12</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1781 target=_blank rel=noopener>13</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1782 target=_blank rel=noopener>14</a>
,
<a href=https://github.com/jupyterhub/binderhub/pull/1783 target=_blank rel=noopener>15</a>
. This refactoring work was very helpful to us, and also appreciated by the broader community.</p><h2 id=defending-against-cryptojacking-with-cryptnono>Defending against cryptojacking with <code>cryptnono</code>
<a class=header-anchor href=#defending-against-cryptojacking-with-cryptnono>#</a></h2><p>For Open Science to flourish, we need to allow access to resources without login / paywalls wherever possible. A new menace against this has been
<a href=https://www.interpol.int/en/Crimes/Cybercrime/Cryptojacking target=_blank rel=noopener>cryptojacking</a>
- where attackers use up any and all available free compute to mine cryptocurrencies. This has affected <em>many</em> folks on the internet, including
<a href=https://www.bleepingcomputer.com/news/security/github-actions-being-actively-abused-to-mine-cryptocurrency-on-github-servers/ target=_blank rel=noopener>GitHub Actions</a>
and mybinder.org, the primary public BinderHub installation. mybinder.org has some extra protections against cryptojacking that aren&rsquo;t easily usable elsewhere, and this has unfortunately meant that the demo JupyterHubs we have with these features enabled have been behind a login wall. I personally believe login walls are long term antithetical to open science, and so this was an important problem to solve.</p><p><a href=https://github.com/cryptnono/cryptnono target=_blank rel=noopener>cryptnono</a>
is an open source project designed to help fight cryptojacking, and as part of this grant we ported some of this functionality out of mybinder.org specific code into cryptnono, so other deployments may also benefit from it! We also migrated to using the super efficient
<a href=https://ebpf.io/ target=_blank rel=noopener>ebpf</a>
Linux Kernel subsystem, allowing for more complex heuristics to catch a much broader range of cryptomining activity. We have been slowly tweaking the config on mybinder.org, and it has proven to be very effective! This will be very helpful for <em>anyone</em> who wants to provide a JupyterHub (or any other computational service) without a login wall. If you are interested in using cryptnono in this fashion, please
<a href=https://github.com/cryptnono/cryptnono/issues target=_blank rel=noopener>reach out to us</a>
so we can work together!</p><h2 id=explored-pathways-that-were-then-discarded>Explored pathways that were then discarded
<a class=header-anchor href=#explored-pathways-that-were-then-discarded>#</a></h2><p>List of things that were tried and then decided as not good pathways:</p><ul><li><a href=https://github.com/consideRatio/repo2docker-service target=_blank rel=noopener>repo2docker-service</a>
, a separate JupyterHub service that could <em>only</em> build images. As we worked on it, we realized that it was replicating a lot of features that BinderHub already has, so we pivoted to working on BinderHub directly instead.</li><li>Building off of
<a href=https://github.com/plasmabio/tljh-repo2docker target=_blank rel=noopener>tljh-repo2docker</a>
. While this already had a nice UI, it would be hard to port it to run on a distributed Kubernetes environment without it becoming a &lsquo;hard fork&rsquo;.</li></ul><p>While these did slow down the implementation of the project, it has allowed us to be very confident that the methods we have chosen are long-term sustainable.</p><h2 id=want-to-try-this-out>Want to try this out?
<a class=header-anchor href=#want-to-try-this-out>#</a></h2><p>We have a demo of this running at
<a href=https://imagebuilding-demo.2i2c.cloud target=_blank rel=noopener>imagebuilding-demo.2i2c.cloud</a>
, but unfortunately as we are still fine-tuning <code>cryptnono</code> config, at this moment it is not open to the public. Please
<a href>contact me</a>
with your GitHub account if you want access, and promise to not be a cryptominer and you shall be granted access.</p><p>Want to set this up on your own JupyterHub? There is some
<a href=https://github.com/2i2c-org/binderhub-service/pull/72 target=_blank rel=noopener>work in progress</a>
documentation and more is being worked on. Drop a line in the linked pull request and we&rsquo;ll be happy to help. The eventual goal is for <em>anyone</em> to be able to simply follow documentation and set this up for themselves.</p><h2 id=future-work>Future work
<a class=header-anchor href=#future-work>#</a></h2><p>This is not complete of course, and there is a lot of future work to be done.</p><ol><li>mybinder.org also helps you distribute your <em>content</em>, not just the environment for your code to run in. Since JupyterHub usually comes with a persistent home directory for the user,
<a href=https://github.com/jupyterhub/nbgitpuller/ target=_blank rel=noopener>nbgitpuller</a>
is commonly used for this purpose instead. We should explore ways to integrate nbgitpuller (and other ways to distribute content) in the future.</li><li>More thorough documentation for how you can recreate what is in the demo for yourself in your own JupyterHub installation.</li><li>Better UX for specifying images, including figuring out how to &lsquo;save&rsquo; them for future reuse.</li><li>Better compatibility with mybinder.org, particularly in allowing other sources of environments (not just GitHub, but Zenodo, raw git repositories, etc) and URL compatibility.</li><li>Better authentication workflow between the frontend and the BinderHub API.</li></ol><h2 id=credit>Credit
<a class=header-anchor href=#credit>#</a></h2><p>All this work would not be possible without a large group of collaborators!</p><ul><li>From 2i2c:
<a href=https://github.com/consideRatio target=_blank rel=noopener>Erik Sundell</a>
,
<a href=https://github.com/GeorgianaElena target=_blank rel=noopener>Georgiana Elena</a>
,
<a href=https://words.yuvi.in/ target=_blank rel=noopener>Yuvi</a>
,
<a href=https://github.com/jmunroe target=_blank rel=noopener>James Munroe</a>
, and
<a href=https://github.com/damianavila target=_blank rel=noopener>Damián Avila</a>
.</li><li>The
<a href=https://github.com/gesiscss/persistent_BinderHub/ target=_blank rel=noopener>persistent BinderHub</a>
project was the direct inspiration for all this work, with particular thanks to
<a href=https://github.com/bitnik target=_blank rel=noopener>Kenan Erdogan</a>
.</li><li>The
<a href=https://github.com/plasmabio/tljh-repo2docker target=_blank rel=noopener>tljh-repo2docker</a>
project, which explores similar ideas in the context of running only on a single node.</li><li>The broad JupyterHub and MyBinder.org community, particularly
<a href=https://github.com/manics target=_blank rel=noopener>Simon Li</a>
and
<a href=https://github.com/minrk/ target=_blank rel=noopener>MinRK</a>
.</li><li>Funding generously provided by
<a href=http://gesis.org target=_blank rel=noopener>GESIS</a>
in cooperation with NFDI4DS (project number:
<a href="https://gepris.dfg.de/gepris/projekt/460234259?context=projekt&amp;task=showDetail&amp;id=460234259&" target=_blank rel=noopener>460234259</a>
) and
<a href=https://www.cessda.eu target=_blank rel=noopener>CESSDA</a>
.</li><li><a href=https://www.gesis.org/en/institute/staff/person/arnim.bleier target=_blank rel=noopener>Arnim Bleier</a>
from GESIS was <em>instrumental</em> in making this project happen.</li></ul></div><div class=share-box><ul class=share></ul></div><div class="media author-card content-widget-hr"><a href=/author/yuvi-panda/><img class="avatar mr-3 avatar-circle" src=/author/yuvi-panda/avatar_huc33b170c6d7c951ba6ff8e7ef074ee49_9242_270x270_fill_q75_lanczos_center.jpeg alt="Yuvi Panda"></a><div class=media-body><h5 class=card-title><a href=/author/yuvi-panda/>Yuvi Panda</a></h5><h6 class=card-subtitle>Senior Open Source Infrastructure Engineer</h6><ul class=network-icon aria-hidden=true><li><a href=mailto:yuvipanda@gmail.com><i class="fas fa-envelope"></i></a></li><li><a href=https://github.com/yuvipanda target=_blank rel=noopener><i class="fab fa-github"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><div class="row justify-content-center mb-4"><div class="col-6 col-md-4"><h5>About</h5><ul class="nav flex-column"><li class="nav-item mb-2"><a href=/organization class="nav-link p-0 text-muted">Team and organization</a></li><li class="nav-item mb-2"><a href=https://compass.2i2c.org class="nav-link p-0 text-muted">Organizational documentation</a></li><li class="nav-item mb-2"><a href=/jobs class="nav-link p-0 text-muted">Jobs at 2i2c</a></li><li class="nav-item mb-2"><a href=/blog class="nav-link p-0 text-muted">Blog</a></li></ul></div><div class="col-6 col-md-4"><h5>Technical</h5><ul class="nav flex-column"><li class="nav-item mb-2"><a href=# class="nav-link p-0 text-muted">GitHub</a></li><li class="nav-item mb-2"><a href=# class="nav-link p-0 text-muted">Documentation</a></li><li class="nav-item mb-2"><a href=# class="nav-link p-0 text-muted">Pricing</a></li></ul></div><div class=col-md-4><form><h5>Subscribe to our newsletter</h5><div><a href="https://2i2c.us2.list-manage.com/subscribe?u=494ab59616acdfc381a699b44&id=94ce07e556">Join our mailing list</a></div></form><h5>Follow us online</h5><style>.footer__brand-icons{font-size:1.3em;display:flex;gap:.5rem}</style><div class=footer__brand-icons><a href=https://github.com/2i2c-org/2i2c-org.github.io><i class="fa-brands fa-github"></i>
</a><a href=https://twitter.com/2i2c_org><i class="fa-brands fa-twitter"></i>
</a><a href=http://eepurl.com/hjHbff><i class="fa-solid fa-envelope"></i></a></div></div></div><div class="license mb-3">© 2024 2i2c. This work is licensed under the <a href=https://creativecommons.org/licenses/by/4.0/>CC-BY 4.0 license</a>.</div><p class=powered-by>Published with <a href="https://hugoblox.com/?utm_campaign=poweredby" target=_blank rel=noopener>Hugo Blox Builder</a> — the free, <a href=https://github.com/HugoBlox/hugo-blox-builder target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.ff7771056d34ad9f2de2d8f6a466e748.js></script><script src=https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.min.js integrity crossorigin=anonymous></script><script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script><script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script><script src=/en/js/wowchemy.min.7f5ebaff62ae468cff8bb3dd1337bb9b.js></script><script src=/js/wowchemy-map.a26e9d2f7238ba5b868384f1c5bc6477.js type=module></script></body></html>